# 跑团视频自动生成

### 使用说明

#### 下载源码

`git clone -b jigsaw  https://github.com/Spiral111/auto_video`	

#### 配置文件

本脚本采用根目录下的`setting.json`作为唯一配置文件，具体可看以下的示例。

*注意：`setting.json`的文件中不能有注释，示例中的注释只为方便理解。*

```json
{
    //百度语音朗读的API_ID,API_KEY,SECRET_KEY
    //如何申请请看：https://jingyan.baidu.com/article/ab0b563063a586c15bfa7d55.html
    "APP_ID": "",
    "API_KEY": "",
    "SECRET_KEY": "",
    //角色语音、位置设置
    "character": {
        "kp": {
            //语速、发音人、音调
            "sound": {
                "spd": 6,
                "per": 2,
                "pid": 4
            },
            //在屏幕的左右，0为左，1为右。
            "location": 0
        },
        "pc": {
            "sound": {
                "spd": 6,
                "per": 1,
                "pid": 4
            },
            "location": 1
        }
    },
    //角色名颜色
    "name_color": {
        "R": 0,
        "G": 128,
        "B": 255
    },
    //文本颜色
    "text_color": {
        "R": 255,
        "G": 255,
        "B": 255
    },
    //每行的文本长度
    "text_len": 36
}
```

### 剧本文件

本脚本默认采用根目录下的`log.txt`作为剧本文件~~，当然你也可以使用GUI来自由选择剧本（TO DO）~~。剧本文件的格式可参照如下示例。

*注意：`log.txt`的编码格式为UTF-8，而且开头和结尾不能有空行。*

```txt
pc
我要跳车

kp
sma二话不说 直接从车上跳了下去，他踩到了路边的狗屎，滚进了泰晤士河。冰凉的河水盖过了他的剧痛，让人仍然保有一丝清醒
```

剧本文件以每两行为一个识别单位，中间的空行作为分隔，第一行为角色名，第二行为文本。

~~*注意：如果角色名为bg，那么文本将会被识别为切换背景文件的指令，不被计入帧数当中。*~~

如果剧本文件中的角色没有在配置文件中，则会使用百度语音合成默认的配置。

#### 图像文件

图像文件统一放置于`image`文件夹内，角色立绘的文件名即为角色名，对话框的文件名需为`dialog`，背景的文件名需为`bg`。

### TO DO List

- [x] 语音编辑GUI
- [x] 立绘左右位置
- [x] 颜色选取
- [ ] 同角色不同立绘
- [ ] 同剧本多张背景图片
- [ ] 解决音画不同步bug
- [ ] 解决重载配置后UI错位bug
- [ ] 自由选取剧本文件